<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Rover Challenge</title>

    <!-- Google Analytics -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-60993769-1', 'auto');
      ga('send', 'pageview');

    </script>

	<!-- Mobile support -->
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="shortcut icon" href="favicon.ico" type="image/favicon">

    <!-- Twitter Bootstrap -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.2/css/bootstrap.min.css" rel="stylesheet">

    <!-- Material Design for Bootstrap -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-material-design/0.2.2/css/material-wfont.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-material-design/0.2.2/css/ripples.min.css" rel="stylesheet">

    <!-- Dropdown.js -->
    <link href="https://cdn.rawgit.com/FezVrasta/dropdown.js/master/jquery.dropdown.css" rel="stylesheet">

    <!-- font awesome -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

    <!-- Octicons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/octicons/2.2.3/octicons.css">

    <!-- material design colours -->
    <!-- production link
    https://cdn.rawgit.com/domhnallohanlon/colours/master/colours.css
     -->
    <link rel="stylesheet" type="text/css" href="https://rawgit.com/domhnallohanlon/colours/master/colours.css">
    
    <!-- local copy
    <link rel="stylesheet" href="../colours/colours.css"> -->

    <!-- toggle menu -->
    <link rel="stylesheet" href="https://cdn.rawgit.com/domhnallohanlon/css/master/navstyle.css">
    
    <link rel="stylesheet" href="sidenav.css">


    <style>
    .media-object{
        width:64px;
    }
    </style>
</head>
<body data-spy="scroll" data-target="#myLittleEye" class="whiteBG">
<div class="navbar navbar-default navbar-fixed-top">
    <div class="navbar-header dcuBG">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-responsive-collapse" aria-expanded="false" aria-controls="navbar">
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
        </button>
        <a class="navbar-brand ochre" href="http://domhnallohanlon.com/ctyirover">DCU Rover Challenge</a>
    </div>
    <div class="navbar-collapse collapse navbar-responsive-collapse dcuBG">
        <ul class="nav navbar-nav">
            <li><a href="index.html"   class="white">
              <i class="octicon octicon-home"></i>
              Home</a></li>
            <li><a href="mech.html"   class="white">
              <i class="octicon octicon-tools"></i>
              Mechanical </a></li>
            <li><a href="elec.html"   class="white">
              <i class="octicon octicon-circuit-board"></i>
              Electronic</a></li>
            <li><a href="software.html"   class="white">
              <i class="octicon octicon-terminal"></i>
              Software</a></li>
            <li class="active"><a href="app.html"   class="white">
              <i class="octicon octicon-device-mobile"></i>
              App</a></li>
            <li><a href="troubleshoot.html" class="white">
              <i class="octicon octicon-bug"></i>
              Troubleshooting</a></li>
            <li><a href="https://github.com/domhnallohanlon/ctyirover" class="white" target="_blank">
              <i class="octicon octicon-mark-github"></i>
              View on GitHub</a></li>                          
        </ul>
<!--         <form class="navbar-form navbar-left">
            <input type="text" class="form-control col-lg-8" placeholder="Search">
        </form> -->

    </div>
</div> <!-- navbar -->

<div class="container">
  <div class="row">
    <!--Nav Bar -->
    <nav class="col-md-2 bs-docs-sidebar hidden-sm hidden-xs">
      <ul id="sidebar" class="nav nav-stacked fixed">
        <li>
          <a href="#overview">Overview</a>
        </li>
        <li>
          <a href="#bluetooth">Bluetooth</a>
          <ul class="nav nav-stacked">
            <li><a href="#adding-bluetooth-module">Connect the Module</a></li>
            <li><a href="#bluetooth-code">Arduino Code</a></li>
          </ul>
        </li>
            <li>
                <a href="#app-inventor">App Development</a>
                <ul class="nav nav-stacked">
                    <li><a href="#design">Design</a></li>
                    <li><a href="#code">Coding</a></li>
                    <li><a href="#test">Testing</a></li>
                </ul>
            </li>
            <li>
              <a href="#arduino">Arduino</a>
              <ul class="nav nav-stacked">
                <li><a href="#finishing-touches">Conclusion</a></li>    
              </ul>
            </li>


        </ul>
    </nav>
    <!--Main Content -->
<div class="col-md-10">
  <section id="overview" class="col-md-10">
  <h1 class="text-center">App Development</h1>
    <h3>Overview</h3>
    <p>
      This tutorial will walk you through the steps required to enable bluetooth communication with your rover and how to create a simple Android app to use as a remote control.

      <img src="img/bluetooth_dongle.JPG" alt="bluetooth" class="img-responsive img-circle center-block">
    </p>
  </section>
<section id="bluetooth" class="col-md-10">
  <h3>Bluetooth</h3>
  <p>Bluetooth is a wireless transfer protocol that allows devices to send data over realtively short distances.</p>

    <h3 id="adding-bluetooth-module" class="subgroup">Adding Bluetooth Module</h3>
    <p>To send and recieve data from your Android device you'll first need to add a bluetooth module to your circuit. For this project we'll be using the popular HC-06 module.</p>

    <div class="panel panel-warning">
        <div class="panel-heading">
          <h3 class="panel-title">
          <i class="fa fa-exclamation-triangle"></i>
          Bluetooth Power Requirements
          </h3>
        </div>
        <div class="panel-body">
          <strong>NOTE:</strong> This module runs on 3.3V so make sure you connect to the correct pin (3.3V) on your Arduino.
        </div>
    </div>

  <p><img src="hc05.png" alt="wiring diagram for HC-O6 and Arduino Uno" class="img-responsive center-block"></p>
  
  <h3 id="bluetooth-code" class="subgroup">Bluetooth Code</h3>
  <p>We'll be using the <code>SoftwareSerial.h</code> Arduino library so you can connect the TX pin to Arduino pin 4 and RX pin to Arduino pin 5.</p>
  <p>To setup we'll load the <code>SoftwarSerial.h</code> library and create a few global variables:</p>

  <p><code data-gist-id="baa3b6be4bf430810479" data-gist-file="btFade.ino" data-gist-line="1-7" data-gist-hide-footer="true"></code></p>

  <p>In the <code>setup()</code> function we <strong>must</strong> initialise <code>mySerial</code> in order to allow the bluetooth module to communicate with the Arduino on the designated pins. If you want to do any debugging with the Arduino serial monitor you should start the serial monitor too.</p>

  <p><code data-gist-id="baa3b6be4bf430810479" data-gist-file="btFade.ino" data-gist-line="8-15" data-gist-hide-footer="true"></code></p>

  <p>Finally, in the <code>loop()</code> function we'll have to read in data from the HC-06 module. To use this as an analog value, such as LED brightness or motor speed, we pass the value we've just read in to an <code>analogWrite()</code> function. To allow our app to send Boolean values (on or off) too the code also makes use of two <code>digtalWrite()</code> functions.</p>

  <p><code data-gist-id="baa3b6be4bf430810479" data-gist-file="btFade.ino" data-gist-line="16-38" data-gist-hide-footer="true"></code></p>
</section> <!-- end of bluetooth section -->

<section id="app-inventor" class="col-md-10">
    <h3>App Development with Thunkable</h3>

    We're going to use Thunkable to design and code our bluetooth apps.
    <br>
    If you haven't used Thunkable yet, use your Google account to <a href="http://app.thunkable.com" target="_blank">sign in here.</a>
    <br>
    To get you up and running quickly click the button below to clone the starter template into your Thunkable account.

    <a href="http://app.thunkable.com/?repo=raw.githubusercontent.com/domhnallohanlon/thunkable_extensions/gh-pages/assets/aia_repo/btrover/btStarterTemplate.asc" class="btn btn-info">Clone Starter Template</a>

    <h3 id="design" class="subgroup"> Design Your User Interface </h3>
    <div class="row">
      <div class="col-md-7">
        <img src="img/p01.png" class="img-responsive"><br>
      </div>
      <div class="col-md-3">
        <p>Create a new project and give it a suitable name</p>
      </div>
    </div>
    <div class="row">
      <div class="col-md-7">
        <img src="img/p02.png" class="img-responsive"><br>
      </div>
      <div class="col-md-3">
        <p>The finished app will have a number of buttons to switch lights on and off as well as connecting and disconnecting to the HC-06</p>
      </div>
    </div>
    <div class="row">
      <div class="col-md-7">
        <img src="img/p03.png" class="img-responsive"><br>
      </div>
      <div class="col-md-3">
        <p>You can modify the properties of your components so that they display something similar to the ones here.</p>
      </div>
    </div>
    <div class="row">
      <div class="col-md-7">
        <img src="img/p04.png" class="img-responsive"><br>
      </div>
      <div class="col-md-3">
        <p>The components themselves are named as follows. The <code>BluetoothClient1</code> component is found in the <b>connectivity</b> section</p>
      </div>
    </div>        
    <h3 id="code" class="subgroup">Code your App</h3>
    <div class="row">
      <div class="col-md-7">
        <img src="img/p05.png" class="img-responsive"><br>
      </div>
      <div class="col-md-3">
        <p>We'll create a number of global variables to monitor the status of our progam. The <code>isConnected</code> variable keeps track of whether or not the App is connected to the HC-06 module.</p>
      </div>
    </div>
    <div class="row">
      <div class="col-md-7">
        <img src="img/p06.png" class="img-responsive"><br>
      </div>
      <div class="col-md-3">
        <p>Next we need to handle what happend when the user clicks on the connect button. The <b>If</b> block is found in the control palette</p>
      </div>
    </div>
    <div class="row">
      <div class="col-md-7">
        <img src="img/p07.png" class="img-responsive"><br>
      </div>
      <div class="col-md-3">
        <p>When the connect button is clicked we want to toggle the status of our <code>isConnected</code> variable. </p>
      </div>
    </div>
    <div class="row">
      <div class="col-md-7">
        <img src="img/p08.png" class="img-responsive"><br>
      </div>
      <div class="col-md-3">
        <p>The label is used to show the user what data has been sent to the bluetooth module.</p>
      </div>
    </div>
    <div class="row">
      <div class="col-md-7">
        <img src="img/p09.png" class="img-responsive"><br>
      </div>
      <div class="col-md-3">
        <p>This code works fine for successful connections, but doesn't handle time-outs. Can you see an easy way to fix this? </p>
      </div>
    </div>
    <div class="row">
      <div class="col-md-7">
        <img src="img/p10.png" class="img-responsive"><br>
      </div>
      <div class="col-md-3">
        <p>Once we've created another global variable called <code>isLighting</code> we can turn on and off the LED.</p>
      </div>
    </div>
    <h3 id="test" class="subgroup">Testing it Out</h3>
    <div class="row">
      <div class="col-md-7">
        <img src="img/p11.png" class="img-responsive"><br>
      </div>
      <div class="col-md-3">
        <p>Since the App Inventor emulator doesn't have bluetooth capabilities you'll have to test on your own phone. <a href="https://play.google.com/store/apps/details?id=edu.mit.appinventor.aicompanion3" target="_blank">Click here</a> to download the MIT AI Companion App</p>
      </div>
    </div>
    <div class="row">
      <div class="col-md-7">
        <img src="img/p12.png" class="img-responsive"><br>
      </div>
      <div class="col-md-3">
        <p>Once installed, simply scan the code or type it into the textbox on your phone to test out the App.</p>
      </div>
    </div>
</section>
<section class="col-md-10" id="arduino">
  <div class="row">
      <h3>Making the Robot Drive</h3>
        The HC-06 module detects signals from the android app. Depending on what command the phone is sending, the robot will drive in a different direction. 
        <p><code data-gist-id="baa3b6be4bf430810479" data-gist-file="btDrive.ino" data-gist-hide-footer="true"></code></p>

    </div>
    <h3 id="finishing-touches" class="subgroup">Finishing Touches</h3>
    <p>If you want to test this app out for yourself you can download it from the Google Play store.<br></p> 
    <a href="https://play.google.com/store/apps/details?id=appinventor.ai_domhnall_ohanlon.btDemo" target="_blank">
      <img src="img/google_play.png" alt="get it on google play">      
    </a><br>
    <p><br><br>To view the source code for this project you can download it using the link below. <br></p>
    <a href="bluetooth_code/btDemo.aia" class="btn btn-success">Download Source</a>
</section>    
</div>
</div>


</div>

<script src="//code.jquery.com/jquery.js"></script>
<script src="//netdna.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/gist-embed/2.4/gist-embed.min.js"></script>

    <script>
      $('body').scrollspy({
          target: '.bs-docs-sidebar',
          offset: 40
      });
    </script>
</body>
</html>